<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>Building StencilJS with TypeScript</title>
    <link href="//fonts.googleapis.com/css?family=Poppins" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/black.css" id="theme">

    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">
    <script src="./node_modules/github-web-components/dist/github-web-components.js"></script>

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );

    </script>

    <style>

      :root {
        --stencil-grape: rgb(88, 81, 255);
      }
      body {
        background: url(images/background.jpg);
        background-size: cover;
      }
      body > div.reveal {
        font-family: 'Poppins', sans-serif;
        color: #B9C0D2;
      }
      .right-info-img {
        width: 100px;
        position: absolute;
        right: 0;
        top: 0;
      }
      .swapgroup .fragment:not(.current-fragment) {
        display: none;
      }
      .reveal h1, .reveal h2, .reveal h3, .reveal h4, .reveal h5 {
        font-family: 'Montserrat', sans-serif;
        color: #FFF;
        text-transform: none;
      }
      .reveal section img.nostyle {
        background: none;
        border: none;
        box-shadow: none;
        margin: 0;
      }
      .example-num {
        position: absolute;
        top: -20px;
        right: -20px;
        font-size: 0.8em;
        color: grey;
      }
      b {
        font-weight: normal;
        color:aqua;
      }
      i {
        font-style: normal;
        color: yellow;
      }
      img.trans {
        background-color: transparent !important;
        border: none !important;
        box-shadow: none !important;
        margin: 0 !important;
      }
    </style>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>

  <body style="background-image: 'images/background.jpg'">

    <div class="reveal">

      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">
        <section>
          <h3>Building StencilJS with TypeScript</h3>
          <p>
            <github-intro userid="jthoms1"></github-intro>
          </p>
        </section>

        <section>
          <h2>About Me</h2>
          <ul>
            <li>Senior Developer at Ionic</li>
            <li>One of the creators of StencilJS</li>
          </ul>
          <aside class="notes">
            <li>Senior Developer at Ionic
            <li>One of the creators of StencilJS
            <li>Today I will be talking about how we built StencilJS on TypeScript
          </aside>
        </section>

        <section data-transition="zoom">
          <img src="images/kids.jpg" />
        </section>

        <section class="swapgroup">
          <h2>
            <span class="fragment fade-in" data-fragment-index="1">
              I <img width="45" class="nostyle" src="images/heart.png"/> JavaScript
            </span>
            <span class="fragment fade-in" data-fragment-index="2">
              I <img width="45" class="nostyle" src="images/heart.png"/> TypeScript
            </span>
            <span class="fragment fade-in" data-fragment-index="3">
              I <img width="45" class="nostyle" src="images/broken-heart.png"/> TypeScript
            </span>
            <span class="fragment fade-in" data-fragment-index="4">
              I <img width="45" class="nostyle" src="images/heart.png"/> TypeScript
            </span>
          </h2>
          <aside class="notes">
            <li>I joined Ionic 2 years ago.
            <li>I was writing primarily React applications before joining Ionic
            <li>My preferred experience was using Babel for my JSX compilation and esnext features, and eslint to keep some code consistency.
            <li>6 months after started I was tasked with rewriting our Node CLI. Of course it was going to be written in Typescript.
            <li>It took about 2 weeks of constantly fighting with the compiler before I started to feel comfortable and
              started embracing it’s type system. I would still consider myself new to Typescript but I have been
              writing it solely for the last 1 ½ years and I would now consider myself an evangelist.
          </aside>
        </section>

        <section>
          <img class="nostyle right-info-img" src="images/ionic.png"/>
          <h2>What is Ionic?</h2>
          <ul>
            <li>Cross platform UI kit</li>
            <li>AngularJS -> Angular<span class="fragment"> -> Stencil</span></li>
            <li>TypeScript</li>
          </ul>
          <aside class="notes">
            <li>Framework/Component Library for mobile applications (Vanity metric) and we offer supporting services
              to these application developers.
            <li>Cross platform UI kit.
            <li>Bootstrap for mobile.
            <li>Software for developers so that they can create amazing web based applications.
            <li>Component library/framework built originally on AngularJS and then Angular /w TypeScript.
            <li>Typescript became the language of Ionic after we adopted it for our v2 release in 2016,
              JavaScript wasn’t written anymore at the company. Our front-end libraries, our node code, our websites,
              our webapps, etc all in TypeScript.
          </aside>
        </section>

        <section>
          <h2>The JS ecosystem is changing</h2>
          <ul>
            <span class="swapgroup">
            <li class="fragment fade-in">'What is best framework?'</li>
            <li class="fragment fade-in">'Which framework do you prefer?'</li>
            </span>
            <li class="fragment fade-in">Components that will work with any framework or no framework</li><br/>
            <li class="fragment fade-in">Write once use everywhere</li>
          </ul>
          <aside class="notes">
            <li>What is the best framework, is no longer the question. The question is which framework do you
              prefer and we want to provide our components to devs no matter the preferred framework.
            <li>Enable our components to work with any framework (or no framework at all)
            <li>We wanted to have our Ionic codebase written in one format and have it work in any
              website or web application. In other words we want to support many frameworks but have our codebase
              written in no framework.  Lets be agnostic
          </aside>
        </section>

        <section>
          <h2>Our Answer was Web Components</h2>
          <img class="nostyle" src="images/web-component-logo.png"/>
          <aside class="notes">
            <li>It was the right time, Chrome had full support, Firefox promised support, and Safari just released a tech preview
              that included support for Web Components.
            <li>So we found our answer and we started building the new Ionic codebase in web components.
            <li>What we found was that we wanted more from what the vanilla experience offered us and we wanted to smooth over
              the edges so we started to spend more time on our own abstractions.
          </aside>
        </section>

        <section>
          <h2>StencilJS Born out of Necessity</h2>
          <ul>
            <li>Realized our work could be valuable to others</li>
            <li>Stencil is a 'compiler' that generates Web Components</li>
            <li>Developer Experience  and app performance are our 2 top priorities</li>
          </ul>
          <aside class="notes">
            <li>We didn’t plan on building a new tool, we just wanted to improve Ionic, but after a few months of
              work we realized that what we were building would be valuable to other software teams as well.
            <li>We took the tool and abstracted it into a separate project from Ionic and we called it Stencil.
            <li>Stencil is a compiler that generates Web Component
            <li>Generates tiny, highly optimized web components.
          </aside>
        </section>

        <section>
          <queue-demo></queue-demo>
        </section>

        <section>
          <h2>StencilJS</h2>
          <ul>
            <li>Reactive Data-binding</li>
            <li>Virtual DOM</li>
            <li>Async rendering queue</li>
            <li>TypeScript</li>
            <li>JSX</li>
          </ul>
          <aside class="notes">
            <li>Marketing speak
          </aside>
        </section>

        <section>
          <h2>StencilJS</h2>
          <ul>
            <li>Have excellent developer ergonomics</li>
            <li>Be able to be lazy loaded</li>
            <li>Be able to stand on their own</li>
            <li>Be type safe</li>
            <li>Be as tiny as possible</li>
          </ul>
          <aside class="notes">
            <li>Inspiration came from a lot of places: Angular, React, Vue, etc.
            <li>Provide excellent developer experience/ergonomics.
            <li>Be standalone, the code should have no references direct dependencies on the Stencil compiler.
            <li>Be type safe.
            <li>export types so that if a dev wants to use a component with any framework + typescript it
              should also allow type safety.
            <li>Be as tiny as possible with as few polyfills as possible.
            <li>Components should be able to work with future versions of the stencil compiler with as few
              breaking changes as possible. Upgrades
          </aside>
        </section>

        <!------------------------------------------------------------------------------------>

        <section>
          <h2>What does a component look like</h2>

          Show picture of code.
          <aside class="notes">
            <li>Lets show how good the ergonomics are
            <li>Component Decorator - similar to Angular information about the component its styles show type def
            <li>Prop Decorator => Define what attributes/properties can be passed to this component... with Types.
            <li>Watch Decorator => Method provided to execute with new, old value on change
            <li>State Decorator => Reactive (Vuejs)
            <li>render Method => JSX (React/Preact)
          </aside>
        </section>

        <section>
          <h2>Keeping code small and portable we needed to compile down to web components.</h2>
          <h2>TypeScript powers the Stencil Compiler</h2>
          <aside class="notes">
            <li>We realized that in order to accomplish what we wanted we needed more than just
              language support, we also need our own compiler.
            <li>We were already using Typescript so the choice was obvious to build our own compiler
              using the provided Compiler API.
          </aside>
        </section>

        <section>
          <h2>Diving into the undocumented APIs of TypeScript</h2>
          <img src="images/dive-fail.gif"/>
        </section>


        <section>
          <h2>Metadata Collection</h2>
          Why would you do this
          - There is alot of valuable information defined by developers while building the components
            that can provide us with valuable information while transforming and generating the resulting code.
          - Examples would be tagName, all style data, what are possible properties, well mostly all decorators.
          How does it work
          - We walk the tree and collect the information and normalize the data based on some usage rules.
          <aside>
            <li>All the data we collected during the metadata collection lets add that back to the component in a straight forward way
          </aside>
        </section>

        <section>
          <h2>Purge</h2>
          Why would you do this
          - Polyfills add extra code.
          How does it work
          - AST transforms to remove decorators
          How does it affect the example
          - show results.
          <aside class="notes">
            <li>removes all decorators that are specific to stencil
            <li>Typescript decorators have some ugly extra code that we don’t need
          </aside>
        </section>

        <section>
          <h2>Conditional Transforms</h2>
          Why would you do this
          - If all components in your project do not use specific features then really non of your runtime needs code around those features
            this allows us to reduce the amount of common code that needs to be shipped to a browser.
          How does it work
          - We use the metadata collection to gain better insight into your components needs and then set flags that allow us to not include these
            features during build time.
          - If you are never listening to a host element then the listener logic is never needed in core, does your project include SVGs.
          <aside class="notes">
            <li>Based on features used we may not need to bundle all of stencil’s runtime just those features that are specified by the code.
          </aside>
        </section>

        <section>
          <h2>Upgrades</h2>
          Explain how we can upgrade
          - Most of our code that compiles down to what we call a standardized target component.  It is normalized across projects and
            potentially across versions of Stencil.
          - If we deprecate a specific feature we allow it to continue to work, provide info that it will be deprecated during compile time
            and then after an upgrade the devs app still works.
          - We also have the ability remove deprecated features from runtime
          Example of text we show when upgrading
          <aside class="notes">
            <li>Read files generated by stencil and decide how they need to change and then also let the dev know that we did this for them.
            <li>ontrol the output of our compiled code and versioned to our compiler means we know exactly how the api changed and then the codemods that need to occur to ensure it works with newer runtime code.
          </aside>
        </section>

        <section>
          <h2>Hints of information that might be missing.</h2>
        </section>

        <section>
          <h2>Documentation generation</h2>
          Almost free
          Example of output and how it relates to collection
          <aside class="notes">
            <li>Similar to the idea of TypeDoc but very specific to components and their own usage
          </aside>
        </section>

        <section>
          <h2>How does it integrate</h2>
          <ul>
            <li>Component Types</li>
            <li>Integrations example</li>
          </ul>
          <aside class="notes">
            <li>We want the ability to have lazy loaded components and get full type support.  Globals here we come.
            <li>Type Safety
            <li>document.createElement + JSX (Preact, React, Vanilla TS)
          </aside>
        </section>

        <section>
          <h2>Next Steps</h2>
          <aside class="notes">
            <li>More documentation and iteration on our road to 1.0
            <li>Unit tests to ensure that we have full coverage and support for many frameworks
          </aside>
        </section>

        <section>
          <h2>Thank You</h2>
        </section>

      </div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script type="text/javascript">
      var start = Date.now();
      var baseEl = document.querySelector('queue-demo');
      function update() {
        baseEl.elapsed = Date.now() - start;
        requestAnimationFrame(update);
      }
      requestAnimationFrame(update);
    </script>

    <script>
      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        transition: 'none', // none/fade/slide/convex/concave/zoom

        // Optional reveal.js plugins
        dependencies: [
          { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: 'plugin/zoom-js/zoom.js', async: true },
          { src: 'plugin/notes/notes.js', async: true }
        ]
      });

    </script>

  </body>
</html>
